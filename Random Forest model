import pandas as pd
from sklearn.ensemble import RandomForestClassifier
from sklearn.metrics import accuracy_score
import os
from pathlib import Path
import pandas as pd


script_dir = Path(__file__).resolve().parent
os.chdir(script_dir)

# Reading the files
train = pd.read_csv("train.csv")
valid = pd.read_csv("val.csv")
test = pd.read_csv("test.csv")

 # Preparing features and labels
X_train = train.drop(columns=["label_move_col"])
y_train = train["label_move_col"]

X_valid = valid.drop(columns=["label_move_col"])
y_valid = valid["label_move_col"]

#  Training the Random Forest model
rf = RandomForestClassifier(n_estimators=100, random_state=42)
rf.fit(X_train, y_train)

# Evaluating on the validation set
y_pred = rf.predict(X_valid)
print("Random Forest Accuracy is:", accuracy_score(y_valid, y_pred))
